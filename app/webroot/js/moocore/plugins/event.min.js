(function(a,d){"function"===typeof define&&define.amd?define("jquery mooFileUploader mooAlert mooBehavior mooAjax mooButton mooPhrase mooGlobal picker_date picker_time spinner typeahead bloodhound tagsinput".split(" "),d):"object"===typeof exports?module.exports=d(require("jquery")):a.mooEvent=d()})(this,function(a,d,e,f,k,h,b,l){var m=function(){var c=new Bloodhound({datumTokenizer:function(a){return Bloodhound.tokenizers.whitespace(a.name)},queryTokenizer:Bloodhound.tokenizers.whitespace,prefetch:{url:mooConfig.url.base+
"/users/friends.json",cache:!1,filter:function(b){return a.map(b.data,function(a){return a})}},identify:function(a){return a.id}});c.initialize();a("#friends").tagsinput({freeInput:!1,itemValue:"id",itemText:"name",typeaheadjs:{name:"friends_userTagging",displayKey:"name",highlight:!0,limit:10,source:c.ttAdapter(),templates:{notFound:['<div class="empty-message">',b.__("no_results"),"</div>"].join(" "),suggestion:function(c){return""!=a("#friends").val()&&-1!=a("#friends").val().split(",").indexOf(c.id)?
'<div class="empty-message" style="display:none">'+b.__("no_results")+"</div>":['<div class="suggestion-item">','<img alt src="'+c.avatar+'"/>','<span class="text">'+c.name+"</span>","</div>"].join("")}}}});a("#sendButton").unbind("click");a("#sendButton").click(function(){a("#sendButton").spin("small");h.disableButton("sendButton");a(".error-message").hide();k.post({url:mooConfig.url.base+"/events/sendInvite",data:a("#sendInvite").serialize()},function(b){h.enableButton("sendButton");a("#sendButton").spin(!1);
b=a.parseJSON(b);1==b.result?a("#simple-modal-body").html(b.msg):(a(".error-message").show(),a(".error-message").html(b.message))});return!1});a("#invite_type_event").change(function(){a("#invite_friend").hide();a("#invite_email").hide();"1"==a("#invite_type_event").val()?a("#invite_friend").show():a("#invite_email").show()})},g=function(){a(".deleteEvent").unbind("click");a(".deleteEvent").click(function(){var c=a(this).data();c=mooConfig.url.base+"/events/do_delete/"+c.id;e.confirm(b.__("are_you_sure_you_want_to_remove_this_event"),
c)})},n=function(){a(".inviteMore").parent().unbind("click");a(".inviteMore").parent().click(function(){var b=a(this).find("a").data();a("#langModal .modal-content").html("");a("#langModal .modal-content").spin("small");a("#langModal .modal-content").load(b.url,function(){a("#langModal .modal-content").spin(!1);a("#langModal").modal("show")})})};return{initOnCreate:function(){new d.fineUploader({element:a("#select-0")[0],multiple:!1,text:{uploadButton:'<div class="upload-section"><i class="material-icons">photo_camera</i>'+
b.__("drag_or_click_here_to_upload_photo")+"</div>"},validation:{allowedExtensions:mooConfig.photoExt,sizeLimit:mooConfig.sizeLimit},request:{endpoint:mooConfig.url.base+"/event/event_upload/avatar"},callbacks:{onError:l.errorHandler,onComplete:function(b,d,e){a("#photo").val(e.filename);a("#item-avatar").attr("src",e.thumb);a("#item-avatar").show();a("#photo").val(e.file_path)}}});a(".datepicker").pickadate({monthsFull:[b.__("january"),b.__("february"),b.__("march"),b.__("april"),b.__("may"),b.__("june"),
b.__("july"),b.__("august"),b.__("september"),b.__("october"),b.__("november"),b.__("december")],monthsShort:[b.__("jan"),b.__("feb"),b.__("mar"),b.__("apr"),b.__("may"),b.__("jun"),b.__("jul"),b.__("aug"),b.__("sep"),b.__("oct"),b.__("nov"),b.__("dec")],weekdaysFull:[b.__("sunday"),b.__("monday"),b.__("tuesday"),b.__("wednesday"),b.__("thursday"),b.__("friday"),b.__("saturday")],weekdaysShort:[b.__("sun"),b.__("mon"),b.__("tue"),b.__("wed"),b.__("thu"),b.__("fri"),b.__("sat")],today:b.__("today"),
clear:b.__("clear"),format:"yyyy-mm-dd",close:!1,onClose:function(){""!=a("#to").val()&&a("#from").val()>a("#to").val()&&(e.alert(b.__("to_date_must_be_greater_than_from_date")),a("#to").val(""));if(""!=a("#to").val()&&a("#from").val()>=a("#to").val()){var c=parseInt(a("#from_time_root .picker__list-item--selected").attr("data-pick")),d=parseInt(a("#to_time_root .picker__list-item--selected").attr("data-pick"));""!=a("#to_time").val()&&d<=c&&(e.alert(b.__("to_time_must_be_greater_than_from_time")),
a("#to").val(""),a("#to_time").val(""))}}});a(".timepicker").pickatime({clear:b.__("clear"),format:"24"==mooConfig.time_format?"H:i":"h:i A",onClose:function(c){if(""!=a("#to").val()&&a("#from").val()>=a("#to").val()){c=parseInt(a("#from_time_root .picker__list-item--selected").attr("data-pick"));var d=parseInt(a("#to_time_root .picker__list-item--selected").attr("data-pick"));""!=a("#to_time").val()&&d<=c&&(e.alert(b.__("to_time_must_be_greater_than_from_time")),a("#to").val(""),a("#to_time").val(""))}}});
a("#saveBtn").unbind("click");a("#saveBtn").click(function(){a(this).addClass("disabled");null!==tinyMCE.activeEditor&&a("#editor").val(tinyMCE.activeEditor.getContent());f.createItem("events",!0)});g()},initOnView:function(){g();n();f.registerEventThumb()},initOnListing:function(){f.initMoreResults();g()},initOnInvitePopup:function(){m()}}});