(function(a,f){"function"===typeof define&&define.amd?define("jquery mooButton mooOverlay mooResponsive mooAjax mooAlert spinner".split(" "),f):"object"===typeof exports?module.exports=f(require("jquery"),require("button")):a.mooBehavior=f()})(this,function(a,f,m,n,p,u){function q(b){b=mooConfig.FeedPluginConfig[b];0!=b.length&&a("body").trigger("enablePluginsCallback",[{plugins:b}])}function h(b){b=mooConfig.FeedPluginConfig[b];0!=b.length&&a("body").trigger("disablePluginsCallback",[{plugins:b}])}
function r(){if(0!=e.length)for(var a=0;a<e.length;a++)h(e[a])}var g=!0,k=function(){a(".view-more .viewMoreBtn").unbind("click");a(".view-more .viewMoreBtn").click(function(){var b=a(this).data();v(b.url,b.div,this)});a(".view-more-chrono .viewMoreBtn").unbind("click");a(".view-more-chrono .viewMoreBtn").click(function(){var b=a(this).data();w(b.url,b.div,this)})},t=function(){a(".view-more .viewMoreBtn").unbind("click");a(".view-more .viewMoreBtn").click(function(){var b=a(this).data();x(b.url,
b.div,this)})},x=function(b,c,d){a(d).spin("small");a(d).parent().css("display","none");a.post(mooConfig.url.base+b,"",function(b){a(d).spin(!1);a("#"+c).find(".view-more:first").remove();a("#"+c).children(".clear:first").remove();a("#"+c).find(".loading:first").remove();a("#"+c).append(b);t()})},v=function(b,c,d){a(d).spin("small");a(d).parent().css("display","none");"undefined"===typeof window.searchParams&&(window.searchParams="");a.post(mooConfig.url.base+b,window.searchParams,function(b){a(d).spin(!1);
a("#"+c).find(".view-more:first").remove();a("#"+c).children(".clear:first").remove();a("#"+c).find(".loading:first").remove();g=!0;"comments"==c||"theaterComments"==c?(a("#"+c).append(b),a("#"+c+" .view-more").insertAfter("#"+c+' li[id^="itemcomment_"]:last')):a("#"+c).append(b);m.registerOverlay();l();a(".tip").tipsy({html:!0,gravity:"s"});window.initShareBtn();n.initFeedImage();k();a("body").trigger("afterMoreResultsBehaviorCallback",[])})},w=function(b,c,d){a(d).spin("small");a(d).parent().css("display",
"none");"undefined"===typeof window.searchParams&&(window.searchParams="");a.post(mooConfig.url.base+b,window.searchParams,function(b){a(d).spin(!1);a("#"+c).find(".view-more:first").remove();a("#"+c).children(".clear:first").remove();a("#"+c).find(".loading:first").remove();g=!0;"comments"==c||"theaterComments"==c?(a("#"+c).prepend(b),a("#"+c+" .view-more").insertAfter("#"+c+' li[id^="itemcomment_"]:last')):a("#"+c).prepend(b);m.registerOverlay();l();a(".tip").tipsy({html:!0,gravity:"s"});window.initShareBtn();
n.initFeedImage();k();a("body").trigger("afterMoreResultsBehaviorCallback",[])})},l=function(){a(".comment_thumb a").length&&a(".comment_thumb a").magnificPopup({type:"image",gallery:{enabled:!1},zoom:{enabled:!0,opener:function(a){return a}}})},e=[];return{initAutoLoadMore:function(){""!=mooConfig.autoLoadMore&&a(window).scroll(function(){var b=a(".view-more");if(0<b.length){var c=a(window),d=c.scrollTop();c=d+c.height();var e=b.offset().top;e+b.height()<=c&&e>=d&&g&&(b.before('<div style="text-align: center" class="loading"><img src="'+
mooConfig.url.base+'/img/loading.gif" /></div>'),b.find("a").trigger("click"),g=!1)}})},createItem:function(b,c){f.disableButton("saveBtn");var d="ajax_save";c&&(d="save");p.post({url:mooConfig.url.base+"/"+b+"/"+d,data:a("#createForm").serialize()},function(c){c=a.parseJSON(c);1==c.result?window.location=mooConfig.url.base+"/"+b+"/view/"+c.id:(f.enableButton("saveBtn"),a(".error-message").show(),a(".error-message").html(c.message),0<a(".spinner").length&&a(".spinner").remove())})},initMoreResults:k,
initMoreResultsPopup:t,toggleCheckboxes:function(b){b.checked?a(".check").attr("checked","checked"):a(".check").attr("checked",!1)},toggleMenu:function(b){"leftnav"==b?"-200px"==a("#leftnav").css("left")?(a("#leftnav").animate({left:0},300),a("#right").animate({right:-204},300),a("#center").animate({left:200},300)):(a("#leftnav").animate({left:-200},300),a("#center").animate({left:0},300)):"-204px"==a("#right").css("right")?(a("#right").show(),a("#right").animate({right:0},300),a("#leftnav").animate({left:-200},
300),a("#center").animate({left:0},300)):a("#right").animate({right:-204},300,function(){a("#right").hide()})},registerImageComment:l,registerEventThumb:function(){a(".event-detail-thumb").length&&a(".event-detail-thumb").magnificPopup({type:"image",gallery:{enabled:!1},zoom:{enabled:!0,opener:function(a){return a}}})},initOnReportItem:function(){a("#reportButton").unbind("click");a("#reportButton").click(function(){f.disableButton("reportButton");a("#reportButton").spin("small");p.post({url:mooConfig.url.base+
"/reports/ajax_save",data:a("#reportForm").serialize()},function(b){f.enableButton("reportButton");a("#reportButton").spin(!1);b=a.parseJSON(b);1==b.result?(a(".error-message").hide(),u.alert(b.message),a("#portlet-config").modal("hide"),a("#themeModal").modal("hide")):(a(".error-message").show(),a(".error-message").html(b.message))})});return!1},initFeedForm:function(){a("body").on("startFeedPlugin3drCallback",function(b,c){-1==e.indexOf(c.plugin_name)&&(e.push(c.plugin_name),h(c.plugin_name),a("body").trigger("listFeedPlugin3drEnableCallback",
[{plugins:e}]))});a("body").on("stopFeedPlugin3drCallback",function(b,c){var d=e.indexOf(c.plugin_name);-1<d&&(q(c.plugin_name),e.splice(d,1),r(),a("body").trigger("listFeedPlugin3drEnableCallback",[{plugins:e}]))});a("body").on("refreshFeedPlugin3drCallback",function(a,c){var b=e.indexOf(c.plugin_name);"add"===c.status?-1==b&&(e.push(c.plugin_name),h(c.plugin_name)):"remove"===c.status&&-1<b&&(e.splice(b,1),q(c.plugin_name),r())})}}});