(function(a,d){"function"===typeof define&&define.amd?define("jquery mooOverlay mooBehavior mooResponsive mooShare mooNotification mooPhoto mooUser tipsy autogrow spinner".split(" "),d):"object"===typeof exports?module.exports=d(require("jquery")):a.ServerJS=d(a.jQuery)})(this,function(a,d,f,g,h,k,l,m){var n=function(){a(".accept-cookie").unbind("click");a(".accept-cookie").on("click",function(){var b=a(this).data("answer");a(this);a.post(mooConfig.url.base+"/users/accept_cookie",{answer:b},function(b){b=
JSON.parse(b);b.result?(a(".cookies-warning").remove(),a("body").removeClass("page_has_cookies")):location.href=b.url})});a(".delete-warning-cookies").unbind("click");a(".delete-warning-cookies").on("click",function(){a(".cookies-warning").remove();a("body").removeClass("page_has_cookies")})},e=function(b){a(b).prev().css("max-height","none");var c=a('<a href="javascript:void(0)" class="show-more">'+a(b).prev().data("less-text")+"</a>");a(b).replaceWith(c);c.click(function(a){p(this)});a("body").trigger("afterShowMoreServerJSCallback",
[])},p=function(b){a(b).prev().css("max-height","");var c=a('<a href="javascript:void(0)" class="show-more">'+a(b).prev().data("more-text")+"</a>");a(b).replaceWith(c);c.click(function(a){e(this)});a("body").trigger("afterShowMoreServerJSCallback",[])},q=function(){500<a(".suggestionInitSlimScroll").height()&&a(".suggestionInitSlimScroll").slimScroll({height:"500px"});a("#global-search").keyup(function(b){var c=a(this).val();""!=c&&a.post(mooConfig.url.base+"/search/suggestion/all",{searchVal:c},
function(b){a(".global-search .slimScrollDiv").show();a("#display-suggestion").html(b).show()});"13"==b.keyCode&&""!=a(this).val()&&(b=a(this).val().replace("#",""),-1<a(this).val().indexOf("#")?window.location=mooConfig.url.base+"/search/hashtags?q="+encodeURIComponent(b):window.location=mooConfig.url.base+"/search/index?q="+encodeURIComponent(b))});a("#global-search").focusout(function(b){0==a("#display-suggestion").is(":hover")&&(a("#display-suggestion").html("").hide(),a(".global-search .slimScrollDiv").hide())});
a("#global-search").focus(function(b){a("#global-search").trigger("keyup")})};return{init:function(){a("textarea:not(.no-grow)").autogrow();a(".tip").tipsy({html:!0,gravity:a.fn.tipsy.autoNS,follow:"x"});a(".truncate").each(function(){if(145<=parseInt(a(this).css("height"))){var b=a('<a href="javascript:void(0)" class="show-more">'+a(this).data("more-text")+"</a>");a(this).after(b);b.click(function(a){e(this)})}});a(".comment-truncate").each(function(){if(45<=parseInt(a(this).css("height"))){var b=
a('<a href="javascript:void(0)" class="show-more">'+a(this).data("more-text")+"</a>");a(this).after(b);b.click(function(a){e(this)})}});d.registerOverlay();f.registerImageComment();a("#keyword").keyup(function(b){if("13"==b.keyCode){a("#browse_all").spin("tiny");a("#browse .current").removeClass("current");a("#browse_all").addClass("current");b="ajax_browse";a(this).hasClass("json-view")&&(b="browse");a(this).hasClass("json-view");var c="";c="albums"==a(this).attr("rel")?"#album-list-content":"#list-content";
a(c).load(mooConfig.url.base+"/"+a(this).attr("rel")+"/"+b+"/search/"+encodeURI(a(this).val()+""),{noCache:1},function(b){a("#browse_all").spin(!1);a("#keyword").val("");a("body").trigger("afterAjaxSearchServerJSCallback",[])})}});n();q();g.init();k.init();h.init();f.initMoreResults();l.init();f.initAutoLoadMore();a("#browse a:not(.overlay):not(.no-ajax)").unbind("click");a("#browse a:not(.overlay):not(.no-ajax)").click(function(){a(this).children(".badge_counter").hide();a(this).spin("tiny");a("#browse .current").removeClass("current");
a(this).parent().addClass("current");var b=a(this).attr("rel");void 0==b&&(b="list-content");var c=a(this);a("#"+b).load(a(this).attr("data-url")+"?"+a.now(),function(b){try{a.parseJSON(b)}catch(r){}c.children(".badge_counter").fadeIn();c.spin(!1);a("textarea:not(.no-grow)").autogrow();a(".tip").tipsy({html:!0,gravity:"s"});d.registerOverlay();a(".truncate").each(function(){if(145<=parseInt(a(this).css("height"))){var b=a('<a href="javascript:void(0)" class="show-more">'+a(this).data("more-text")+
"</a>");a(this).after(b);b.click(function(a){e(this)})}});window.history.pushState({},"",c.attr("href"));992>a(window).width()&&(console.log("222"),a("#leftnav").modal("hide"),a("body").scrollTop(0));a("body").trigger("afterAjaxMenuServerJSCallback",[])});return!1});m.resendValidationLink();a("body").append('<input type="hidden" id="url_path" value="'+window.location.pathname+'">')}}});