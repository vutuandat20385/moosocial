(function(a,b){"function"===typeof define&&define.amd?define("jquery mooPhrase mooUser mooEmoji hideshare bootstrap".split(" "),b):"object"===typeof exports?module.exports=b(require("jquery")):a.mooShare=b()})(this,function(a,b,h,m){var f=0;window.closeModal=function(){a("#shareFeedModal").modal("hide")};window.statusModal=function(c,l){a.fn.SimpleModal({btn_ok:b.__("btn_ok"),btn_cancel:b.__("btn_cancel"),model:"modal",title:c,contents:l}).showModal()};window.initShareBtn=function(){a("body").off("click",
    ".shareFeedBtn").on("click",".shareFeedBtn",function(){if(!h.validateUser())return!1;var b=a(this).attr("share-url");a.post(mooConfig.url.base+"/share/index",function(c){try{c=JSON.parse(c),c.nonLogin&&h.validateUser()}catch(e){a("#shareFeedModal iframe").attr("src",b),a("#shareFeedModal").modal({show:!0})}})})};a(document).keyup(function(a){if(27==a.keyCode&&1==f)return k()});var k=function(){if(1==f){var c=b.__("are_you_sure_leave_this_page");if(confirm(c))return f=0,a(window).unbind("beforeunload"),
    a("#themeModal").modal("hide"),!0}else f=0,a("#themeModal").modal("hide")};return{init:function(){a(window).on("beforeunload",function(){if(1==f)return k()});window.initShareBtn();a("#shareFeedModal").on("hidden.bs.modal",function(b){document.getElementById("iframeShare").height="0px";a(b.target).removeData("bs.modal")})},initOnAjaxShare:function(c){a(".sharethis").hideshare({linkedin:!1,link:c.social_link_share});a("#myTabDrop1").click(function(){a("#myTabDrop1-contents").toggleClass("show_hide_dropdown")});
    var f=null;a('a[data-toggle="tab"]').on("shown.bs.tab",function(b){a("#shareWarning").html("");a("#recaptcha_content").hide();f=b=a(b.target).attr("href");a("#share_type").val(b);switch(b){case "#friend":case "#msg":a("#friend").addClass("active in");a("#msg").remove("active in");break;case "#email":a("#recaptcha_content").show()}a("#myTabDrop1").html(a(this).html());a("body").height();a("#page_share-ajax_share .userTagged").css("position","fixed")});a('a[data-toggle="tab"]').click(function(){a("#myTabDrop1-contents").removeClass("show_hide_dropdown")});
    a("#shareBtn").click(function(){a("#shareWarning").html("");switch(f){case "#friend":if(""==a("#friendSuggestion").val()){a("#shareWarning").html("<span>"+b.__("please_select_friends_to_share")+"</span>");return}break;case "#msg":if(""==a("#friendSuggestion").val()){a("#shareWarning").html("<span>"+b.__("please_select_friends_to_share")+"</span>");return}break;case "#group":if(""==a("#groupSuggestion").val()){a("#shareWarning").html("<span>"+b.__("please_select_groups_to_share")+"</span>");return}break;
        case "#email":if(""==a('textarea[name="data[email]"]').val()){a("#shareWarning").html("<span>"+b.__("please_input_emails_to_share")+"</span>");return}}a("#shareBtn").addClass("disabled");a.post(c.do_share_url,a("#activity_share_form").serialize(),function(d){d=a.parseJSON(d);d.success?(window.parent.closeModal(),window.parent.statusModal(b.__("status"),d.msg)):(a("#shareWarning").html("<span>"+d.msg+"</span>"),a("#shareBtn").removeClass("disabled"))})});var e="",d="",g="";a("#myTabDrop1-contents li a").on("click",
        function(){var b=a(this).attr("href"),c=a(this).parents("#content-wrapper");"#msg"==b||"#email"==b||"#socialshare"==b?(e=c.find("textarea#message"),d=c.find(".textoverlay-wrapper"),g=c.find(".userTagged .user-tagging-container"),0<d.length?(d.hide(),d.find("input.messageHidden").attr("name","messageTextHidden")):(e.hide(),e.attr("name","messageTextHidden")),c.find("#messageHidden").attr({name:"data[message]"}),c.find("#messageHidden").val(""),c.find("#messageHidden").show(),g.hide()):"object"===typeof e&&
            ("object"===typeof d&&(c.find("#messageHidden").attr("name","messageTextHidden").hide(),0<d.length?(d.find("input.messageHidden").attr("name","data[message]"),d.find("input.messageHidden").val(""),d.find("div.textoverlay").html(""),d.show()):(e.attr("name","data[message]"),e.show()),e.val("")),"object"===typeof g&&g.show(),e=d=g="")})}}});